# ML-chess
# written and designed by Peter Flockhart and Henry Johnson for CS 542

This project runs primarily on the Python library Keras, built on a TensorFlow backend. It is essential to have these two libraries installed before running most parts of the project.
This project also makes fairly extensive use of the numpy library, as well as a couple uses of sci-kit learn.
It's recommended that these libraries are loaded and run in a virtual environmnent to avoid running into conflicting installs of python etc on the machine. If the repo is cloned and all the libraries are installed on the machine, opening the virtual environment can be achieved by running "source tensorflow/bin/activate" in the command line.

Our compiled and trained models are saved under the names "chess_model.h5" and "piece_count_5_layer.h5".
The models can be loaded and used to predict chess position evaluations either in a script or within the python interpreter using the load_model() and predict() functions in the keras models library

To train the models from scratch, the files model.py and piece_count_model.py can be run. These will load our training and testing data from pickle files.
for the full-size model, roughly 200,000 input-output pairs are contained in the file full_data_set.p while the input-output pairs for the smaller model are in piece_count_data.p
smaller data sets are contained in files ending in -interrupt.p as well as training_set_2.p and training_set_3.p

to run tests to measure the performance of the models outside of validation during training, the file test_models.py will measure and print the metrics we have deemed appropriate for both models.

our data sets were generated by running pgn_to_vector.py which loads .pgn files containing sets of chess games. Due to time constraints our largest training set consisted of roughly 200000 input-output pairs but given enough time this file should generate and the models should be able to train on arbitrarily large data sets.

to load or run anything independently, the file dependency.py can be opened in the python interpreter and will import all libraries needed to interact with our code and data.

